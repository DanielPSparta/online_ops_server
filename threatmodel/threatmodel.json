{
  "mitigations": [],
  "exposures": [],
  "transfers": [],
  "acceptances": [],
  "connections": [
    {
      "source_component": "#guest",
      "destination_component": "#index",
      "direction": "to",
      "details": "HTTPs-GET",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #guest to #index with HTTPs-GET",
        "code": "# @connects #guest to #index with HTTPs-GET\n\n@flask_app.route('/', methods = ['POST','GET'])\ndef index_page():\n    print(request.headers)\n    isUserLoggedIn = False\n",
        "filename": "/home/kali/cyber/projects2/online_ops/app/main.py",
        "line": 1
      }
    },
    {
      "source_component": "#vpc",
      "destination_component": "#igw",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #vpc to #igw with network traffic",
        "code": "# @connects #vpc to #igw with network traffic\nresource \"aws_vpc\" \"cyber94_full_dpook_vpc_tf\" {\n  cidr_block       = \"10.105.0.0/16\"\n  tags = {\n    Name = \"cyber94_full_dpook_vpc\"\n  }\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#igw",
      "destination_component": "#vpc",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #igw to #vpc with network traffic",
        "code": "# @connects #igw to #vpc with network traffic\nresource \"aws_internet_gateway\" \"cyber94_full_dpook_igw_tf\" {\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n\n  tags = {\n    Name = \"cyber94_full_dpook_igw\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#igw",
      "destination_component": "#rt",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #igw to #rt with network traffic",
        "code": "# @connects #igw to #rt with network traffic\nresource \"aws_internet_gateway\" \"cyber94_full_dpook_igw_tf\" {\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n\n  tags = {\n    Name = \"cyber94_full_dpook_igw\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#rt",
      "destination_component": "#igw",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #rt to #igw with network traffic",
        "code": "# @connects #rt to #igw with network traffic\nresource \"aws_route_table\" \"cyber94_full_dpook_rt_tf\" {\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#naclapp",
      "destination_component": "#subnetapp",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #naclapp to #subnetapp with network traffic",
        "code": "# @connects #naclapp to #subnetapp with network traffic\nresource \"aws_subnet\" \"cyber94_full_dpook_subnet_app_tf\" {\n  vpc_id     = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  cidr_block = \"10.105.1.0/24\"\n  tags = {\n    Name = \"cyber94_full_dpook_subnet_app\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#subnetapp",
      "destination_component": "#naclapp",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #subnetapp to #naclapp with network traffic",
        "code": "# @connects #subnetapp to #naclapp with network traffic\nresource \"aws_subnet\" \"cyber94_full_dpook_subnet_app_tf\" {\n  vpc_id     = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  cidr_block = \"10.105.1.0/24\"\n  tags = {\n    Name = \"cyber94_full_dpook_subnet_app\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#naclsql",
      "destination_component": "#subnetsql",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #naclsql to #subnetsql with network traffic",
        "code": "# @connects #naclsql to #subnetsql with network traffic\nresource \"aws_subnet\" \"cyber94_full_dpook_subnet_db_tf\" {\n  vpc_id     = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  cidr_block = \"10.105.2.0/24\"\n  tags = {\n    Name = \"cyber94_full_dpook_subnet_db\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#subnetsql",
      "destination_component": "#naclsql",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #subnetsql to #naclsql with network traffic",
        "code": "# @connects #subnetsql to #naclsql with network traffic\nresource \"aws_subnet\" \"cyber94_full_dpook_subnet_db_tf\" {\n  vpc_id     = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  cidr_block = \"10.105.2.0/24\"\n  tags = {\n    Name = \"cyber94_full_dpook_subnet_db\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#naclbastion",
      "destination_component": "#subnetbastion",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #naclbastion to #subnetbastion with network traffic",
        "code": "# @connects #naclbastion to #subnetbastion with network traffic\nresource \"aws_subnet\" \"cyber94_full_dpook_subnet_bastion_tf\" {\n  vpc_id     = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  cidr_block = \"10.105.3.0/24\"\n  tags = {\n    Name = \"cyber94_full_dpook_subnet_bastion\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#subnetbastion",
      "destination_component": "#naclbastion",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #subnetbastion to #naclbastion with network traffic",
        "code": "# @connects #subnetbastion to #naclbastion with network traffic\nresource \"aws_subnet\" \"cyber94_full_dpook_subnet_bastion_tf\" {\n  vpc_id     = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  cidr_block = \"10.105.3.0/24\"\n  tags = {\n    Name = \"cyber94_full_dpook_subnet_bastion\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#rt",
      "destination_component": "#naclapp",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #rt to #naclapp with network traffic",
        "code": "# @connects #rt to #naclapp with network traffic\nresource \"aws_network_acl\" \"cyber94_full_dpook_nacl_app_tf\" {\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  subnet_ids = [aws_subnet.cyber94_full_dpook_subnet_app_tf.id]\n\n  egress {\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#naclapp",
      "destination_component": "#rt",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #naclapp to #rt with network traffic",
        "code": "# @connects #naclapp to #rt with network traffic\nresource \"aws_network_acl\" \"cyber94_full_dpook_nacl_app_tf\" {\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  subnet_ids = [aws_subnet.cyber94_full_dpook_subnet_app_tf.id]\n\n  egress {\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#rt",
      "destination_component": "#naclbastion",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #rt to #naclbastion with network traffic",
        "code": "# @connects #rt to #naclbastion with network traffic\nresource \"aws_network_acl\" \"cyber94_full_dpook_nacl_bastion_tf\" {\n\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  subnet_ids = [aws_subnet.cyber94_full_dpook_subnet_bastion_tf.id]\n\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#naclbastion",
      "destination_component": "#rt",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #naclbastion to #rt with network traffic",
        "code": "# @connects #naclbastion to #rt with network traffic\nresource \"aws_network_acl\" \"cyber94_full_dpook_nacl_bastion_tf\" {\n\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  subnet_ids = [aws_subnet.cyber94_full_dpook_subnet_bastion_tf.id]\n\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#rt",
      "destination_component": "#naclsql",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #rt to #naclsql with network traffic",
        "code": "# @connects #rt to #naclsql with network traffic\nresource \"aws_network_acl\" \"cyber94_full_dpook_nacl_db_tf\" {\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  subnet_ids = [aws_subnet.cyber94_full_dpook_subnet_db_tf.id]\n\n  egress {\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#naclsql",
      "destination_component": "#rt",
      "direction": "to",
      "details": "network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #naclsql to #rt with network traffic",
        "code": "# @connects #naclsql to #rt with network traffic\nresource \"aws_network_acl\" \"cyber94_full_dpook_nacl_db_tf\" {\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  subnet_ids = [aws_subnet.cyber94_full_dpook_subnet_db_tf.id]\n\n  egress {\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#sg_app",
      "destination_component": "#subnetapp",
      "direction": "to",
      "details": "Network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #sg_app to #subnetapp with Network traffic",
        "code": "# @connects #sg_app to #subnetapp with Network traffic\nresource \"aws_security_group\" \"cyber94_full_dpook_sg_app_tf\" {\n  name = \"cyber94_full_dpook_sg_app\"\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  ingress{\n    from_port = 22\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#subnetapp",
      "destination_component": "#sg_app",
      "direction": "to",
      "details": "Network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #subnetapp to #sg_app with Network traffic",
        "code": "# @connects #subnetapp to #sg_app with Network traffic\nresource \"aws_security_group\" \"cyber94_full_dpook_sg_app_tf\" {\n  name = \"cyber94_full_dpook_sg_app\"\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  ingress{\n    from_port = 22\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#sg_sql",
      "destination_component": "#subnetsql",
      "direction": "to",
      "details": "Network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #sg_sql to #subnetsql with Network traffic",
        "code": "# @connects #sg_sql to #subnetsql with Network traffic\nresource \"aws_security_group\" \"cyber94_full_dpook_sg_db_tf\" {\n\n  name = \"cyber94_full_dpook_sg_db\"\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  ingress{\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#subnetsql",
      "destination_component": "#sg_sql",
      "direction": "to",
      "details": "Network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #subnetsql to #sg_sql with Network traffic",
        "code": "# @connects #subnetsql to #sg_sql with Network traffic\nresource \"aws_security_group\" \"cyber94_full_dpook_sg_db_tf\" {\n\n  name = \"cyber94_full_dpook_sg_db\"\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  ingress{\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#sg_bastion",
      "destination_component": "#subnetbastion",
      "direction": "to",
      "details": "Network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #sg_bastion to #subnetbastion with Network traffic",
        "code": "# @connects #sg_bastion to #subnetbastion with Network traffic\nresource \"aws_security_group\" \"cyber94_full_dpook_sg_bastion_tf\" {\n\n  name = \"cyber94_full_dpook_sg_bastion\"\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  ingress{\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#subnetbastion",
      "destination_component": "#sg_bastion",
      "direction": "to",
      "details": "Network traffic",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #subnetbastion to #sg_bastion with Network traffic",
        "code": "# @connects #subnetbastion to #sg_bastion with Network traffic\nresource \"aws_security_group\" \"cyber94_full_dpook_sg_bastion_tf\" {\n\n  name = \"cyber94_full_dpook_sg_bastion\"\n  vpc_id = aws_vpc.cyber94_full_dpook_vpc_tf.id\n  ingress{\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#sg_app",
      "destination_component": "#app_server",
      "direction": "to",
      "details": "Network",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #sg_app to #app_server with Network",
        "code": "# @connects #sg_app to #app_server with Network\n\nresource \"aws_instance\" \"cyber94_full_dpook_app_tf\" {\n  subnet_id = aws_subnet.cyber94_full_dpook_subnet_app_tf.id\n  ami = \"ami-0943382e114f188e8\"\n  instance_type = \"t2.micro\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#app_server",
      "destination_component": "#sg_app",
      "direction": "to",
      "details": "Network",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #app_server to #sg_app with Network",
        "code": "# @connects #app_server to #sg_app with Network\n\nresource \"aws_instance\" \"cyber94_full_dpook_app_tf\" {\n  subnet_id = aws_subnet.cyber94_full_dpook_subnet_app_tf.id\n  ami = \"ami-0943382e114f188e8\"\n  instance_type = \"t2.micro\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#app_server",
      "destination_component": "#sql_server",
      "direction": "to",
      "details": "SQL request",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #app_server to #sql_server with SQL request",
        "code": "# @connects #app_server to #sql_server with SQL request\n\nresource \"aws_instance\" \"cyber94_full_dpook_app_tf\" {\n  subnet_id = aws_subnet.cyber94_full_dpook_subnet_app_tf.id\n  ami = \"ami-0943382e114f188e8\"\n  instance_type = \"t2.micro\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#bastion_server",
      "destination_component": "#sql_server",
      "direction": "to",
      "details": "SSH_Responce",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #bastion_server to #sql_server with SSH_Responce",
        "code": "# @connects #bastion_server to #sql_server with SSH_Responce\n\nresource \"aws_instance\" \"cyber94_full_dpook_db_tf\" {\n  subnet_id = aws_subnet.cyber94_full_dpook_subnet_db_tf.id\n  ami = \"ami-0d1c7c4de1f4cdc9a\"\n  instance_type = \"t2.micro\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#sql_server",
      "destination_component": "#web_server",
      "direction": "to",
      "details": "SQL responce",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #sql_server to #web_server with SQL responce",
        "code": "# @connects #sql_server to #web_server with SQL responce\n\nresource \"aws_instance\" \"cyber94_full_dpook_db_tf\" {\n  subnet_id = aws_subnet.cyber94_full_dpook_subnet_db_tf.id\n  ami = \"ami-0d1c7c4de1f4cdc9a\"\n  instance_type = \"t2.micro\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#sg_bastion",
      "destination_component": "#bastion_server",
      "direction": "to",
      "details": "Network",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #sg_bastion to #bastion_server with Network",
        "code": "# @connects #sg_bastion to #bastion_server with Network\n\nresource \"aws_instance\" \"cyber94_full_dpook_bastion_tf\" {\n  subnet_id = aws_subnet.cyber94_full_dpook_subnet_bastion_tf.id\n  ami = \"ami-0943382e114f188e8\"\n  instance_type = \"t2.micro\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#bastion_server",
      "destination_component": "#sg_bastion",
      "direction": "to",
      "details": "Network",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #bastion_server to #sg_bastion with Network",
        "code": "# @connects #bastion_server to #sg_bastion with Network\n\nresource \"aws_instance\" \"cyber94_full_dpook_bastion_tf\" {\n  subnet_id = aws_subnet.cyber94_full_dpook_subnet_bastion_tf.id\n  ami = \"ami-0943382e114f188e8\"\n  instance_type = \"t2.micro\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    },
    {
      "source_component": "#sql_server",
      "destination_component": "#bastion_server",
      "direction": "to",
      "details": "SSH_Request",
      "description": "",
      "custom": {},
      "source": {
        "annotation": "@connects #sql_server to #bastion_server with SSH_Request",
        "code": "# @connects #sql_server to #bastion_server with SSH_Request\n\nresource \"aws_instance\" \"cyber94_full_dpook_bastion_tf\" {\n  subnet_id = aws_subnet.cyber94_full_dpook_subnet_bastion_tf.id\n  ami = \"ami-0943382e114f188e8\"\n  instance_type = \"t2.micro\"\n",
        "filename": "/home/kali/cyber/projects2/online_ops/terraform-full-infra/main.tf",
        "line": 1
      }
    }
  ],
  "reviews": [],
  "tests": [],
  "run_id": "cb177e4e478b4008aae97092de596204"
}